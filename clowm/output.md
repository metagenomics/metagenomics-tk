# Metagenomics-Toolkit: Output

## Quality Control
The output is a gzipped fastq file (`SAMPLE_interleaved.qc.fq.gz`) containing trimmed and quality-filtered reads.

## Assembly
The output contains the following files:

* A gzipped FASTA file containing contigs.
* A file containing the assembly graph in FASTG format.
* A file containing assembly statistics.

## Binning
The output contains:

* the binning results in the MetaBAT folder.
* the coverage of each contig and MAG.
* the read mapping to each contig and MAG, and the corresponding mapping statistics.

## Mag Attributes

### CheckM
The CheckM output adds a `BIN_ID` and `SAMPLE` column to the corresponding CheckM output file.

### GTDB-Tk
All GTDB .tsv files include the GTDB specific columns in addition to a `SAMPLE` column (`*_SAMPLE_gtdbtk.bac120.summary.tsv`,
`*_SAMPLE_gtdbtk.ar122.summary.tsv`). In addition, this module produces a file `*_SAMPLE_gtdbtk_combined.tsv` that combines
both files and adds a `BIN_ID` column. A reference tree file (`*.tree`) in Newick format containing query genomes placed with pplacer is also produced.

## Annotation

### Prokka
Prokka computes `*.err`, `*.faa`, `*.ffn`, `*.fna`, `*.fsa`, `*.gbk`, `*.gff`, `*.sqn`, `*.tbl`, `*.tbl` for every bin.
`*.gbk` and `*.sqn` are skipped per default, since tbl2asn runs for quite a while! If you need those files generated by
prokka, include: `--tbl2asn` in the prokka parameters to enable it. Details of all files can be read on the Prokka page.

### MMseqs2
Calculated significant matches of a protein query which was compared against a set of databases.

The following output files are produced:

* `SAMPLE_binned.databasename.blast.tsv` for the binned contigs
* `SAMPLE_unbinned.databasename.blast.tsv` for the unbinned contigs
* `SAMPLE_plasmid.databasename.blast.tsv` for the assembled plasmids

### MMseqs2 - Taxonomy
By identifying homologous through searches against a provided MMseqs2 GTDB taxonomy-database, MMseqs2 can compute the lowest
common ancestor. This lowest common ancestor is a robust taxonomic label for unknown sequences. These labels are presented in form of an `*.taxonomy.tsv` file, a `*.krakenStyleTaxonomy.out` formatted in accordance to the [KRAKEN](https://ccb.jhu.edu/software/kraken/) tool outputs and an interactive [KRONA](https://github.com/marbl/Krona/wiki) plot in form of a html website `*.krona.html`.

### Resistance Gene Identifier (rgi)
The `*rgi.tsv` files contain the found CARD genes.

## Plasmids

### SCAPP
SCAPP detects plasmid sequences out of the samples assembly graph. It reports sequences as gzipped FASTA files
(`*_plasmids.fasta.gz`). A basic statistic (`*_plasmids_stats.tsv`) per plasmid and a summary statistic
(`*_plasmids_summary_stats.tsv`) over all plasmids is also generated. CoverM coverage metrics are generated for all
plasmids. Gene coverage values are generated as part of the annotation module output.

### PlasClass
PlasClass can identify plasmids by using a statistical model that was build using kmer frequencies.
It reports gzipped fata files and their probabilities (`*_plasclass.tsv`).

### ViralVerify Plasmid
ViralVerify is applying a Naive Bayes classifier (`*_viralverifyplasmid.tsv`).

### PLSDB
PLSDB includes a curated set of plasmid sequences that were extracted from databases like refseq. Metadata of
the found sequences is reported in `*.tsv` and the metadata of the filtered sequences in `*_kmerThreshold_X.tsv`.

### Filtered
All Contigs that were identified as plasmids by all tools that were activated as a filter (`--steps.plasmid.PlasClass.filter`). If `--steps.plasmid.Filter.method` (excluding assembled plasmids by e.g. SCAPP). Which tools detected a plasmid on which contig is saved in a file named `*_detection_tools.tsv`.
