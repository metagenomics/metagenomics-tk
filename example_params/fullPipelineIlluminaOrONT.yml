tempdir: "tmp"
s3SignIn: true
input:
  paired:
    path: "test_data/fullPipeline/reads_split.tsv"
    watch: false
  ont:
    path: "test_data/fullPipeline/ont.tsv"
    watch: false
output: "output"
logDir: log
runid: 1
databases: "/mnt/databases"
logLevel: 1
scratch: "/vol/scratch"
steps:
  qc:
    fastp:
       # Example params: " --cut_front --cut_tail --detect_adapter_for_pe  "
      additionalParams:
        fastp: "  "
        reportOnly: false
      timeLimit: "AUTO"
    filterHuman:
      additionalParams: "  "
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/human_filter.db.20231218v2.gz
          md5sum: cc92c0f926656565b1156d66a0db5a3c
    nonpareil:
       additionalParams: " -v 10 -r 1234 "
    kmc:
      timeLimit: "AUTO"
      additionalParams: 
         count: " -sm -ci2 -cs10000  "
         histo: " -cx50000 "
  assembly:
    megahit:
      additionalParams: " --min-contig-len 200 "
      fastg: true
      resources:
        RAM: 
          mode: 'PREDICT'
          predictMinLabel: 'medium' 
  qcONT:
    porechop:
       additionalParams:
         chunkSize: 450000
         porechop: ""
         filtlong: " --min_length 1000 --keep_percent 90  "
    filterHumanONT:
      additionalParams: "  "
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/human_filter.db.20231218v2.gz
          md5sum: cc92c0f926656565b1156d66a0db5a3c
    nanoplot:
      additionalParams: ""
  assemblyONT:
    metaflye:
      additionalParams: " -i 1 "
      quality: "AUTO"
  binning:
    bwa2:
      additionalParams: 
        bwa2: "  "
        # samtools flags are used to filter resulting bam file
        samtoolsView: " -F 3584 " 
    contigsCoverage:
      additionalParams: ""
    genomeCoverage:
      additionalParams: ""
    metabat:
      additionalParams: " --seed 234234  "
    metabinner:
      minContigLength: 500
      kmerSize: 4
    magscot:
      additionalParams: ""
      prodigal:
        additionalParams: " -p meta "
      hmmSearch:
        additionalParams: "--noali --notextw --cut_nc"
        database:
          download:
            source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/gtdbtk_r226_v2_data.tar.gz
            md5sum: 5838457cd9f9456d1996a625ee834623
  binningONT:
    minimap:
      additionalParams: 
        minimap: " "
        # samtools flags are used to filter resulting bam file
        samtoolsView: " -F 3584 " 
    contigsCoverage:
      additionalParams: ""
    genomeCoverage:
      additionalParams: ""

    metabat:
      additionalParams: " --seed 234234  "
  magAttributes:
    gtdb:
      buffer: 1000
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/gtdbtk_r226_v2_data.tar.gz
          md5sum: 5838457cd9f9456d1996a625ee834623
      additionalParams: " --min_af 0.65 --scratch_dir . "
    checkm2:
      database:
        download:
          source: "https://openstack.cebitec.uni-bielefeld.de:8080/databases/checkm2_v2.tar.gz"
          md5sum: a634cb3d31a1f56f2912b74005f25f09
      additionalParams: "  "
  dereplication:
    bottomUpClustering:
      minimumCompleteness: 0
      maximumContamination: 5000
      ANIBuffer: 20
      mashBuffer: 2000
      method: 'ANI'
      additionalParams:
        mash_sketch: ""
        mash_dist: ""
        # cluster cutoff
        cluster: " -c 0.05 "
        pyani: " -m ANIb "
        representativeAniCutoff: 0.95
  fragmentRecruitment:
    mashScreen:
      genomes: test_data/fragmentRecruitment/mags.tsv
      unzip:
        timeLimit: "AUTO"
      additionalParams:
        mashSketch: " "
        mashScreen: " "
        bwa2: " "
        samtoolsViewBwa2: " -F 3584 " 
        samtoolsViewMinimap: " " 
        coverm: "  --min-covered-fraction 0 "
        covermONT: "  --min-covered-fraction 0 "
        minimap: "  "
      mashDistCutoff: 0.05
      coveredBasesCutoff: 0.01
      mashHashCutoff: 2
    genomeCoverage:
      additionalParams: ""
    contigsCoverage:
      additionalParams: ""
  readMapping:
    bwa2:
      additionalParams:
        bwa2_index: ""
        bwa2_mem: ""
    coverm: " --min-covered-fraction 0 "
    covermONT: " --min-covered-fraction 0 "
    minimap:
      additionalParams:
        minimap_index: ""
        minimap: ""
  annotation:
    prokka:
      prodigalMode: "meta"
      defaultKingdom: false
      additionalParams: " --mincontiglen 200 "
    whokaryote:
      additionalParams: " --minsize 3000 "
    mmseqs2:
      chunkSize: 20000
      kegg:
        additionalParams:
          search :  ' -s 2 --exact-kmer-matching 1 '
          additionalColumns: ""
        database:
          extractedDBPath: '/vol/spool/toolkit/kegg-mirror-202506_mmseqs/keggDB'
#      vfdb:
#        params: ' -s 2 --exact-kmer-matching 1 '
#        database:
#          download:
#            source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/vfdb_full_20250620.tar.zst
#            md5sum: f2ab1259b36fa906ff91f2575e8ee442
#      bacmet20_experimental:
#        params: ' -s 2 --exact-kmer-matching 1 '
#        database:
#          download:
#            source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/bacmet20_experimental.tar.zst
#            md5sum: 57a6d328486f0acd63f7e984f739e8fe
      bacmet20_predicted:
        additionalParams:
          search :  ' -s 2 --exact-kmer-matching 1 '
          additionalColumns: ""
        database:
          download:
            source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/bacmet20_predicted.tar.zst
            md5sum: 55902401a765fc460c09994d839d9b64
    rgi:
      additionalParams: ""
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/card_broadstreet-v4.0.1.tar.bz2
          md5sum: 2396eaf95f2d35c58c135f7db2211dbb
    mmseqs2_taxonomy:
      runOnMAGs: true
      gtdb:
        params: ' --orf-filter-s 1 -e 1e-15'
        ramMode: false
        initialMaxSensitivity: 1
        database:
          download:
            source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/gtdb_r226_mmseqs_taxonomy.tar.gz
            md5sum: a1d77c776a16666ad97ce4945e5e7a35
      ncbi_nr:
        params: ' --orf-filter-s 1 -e 1e-15'
        ramMode: false
        initialMaxSensitivity: 1
        database:
          download:
            source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/nr_2023-04-29_mmseqs_taxonomy.tar.zst
            md5sum: 79b9fb6b3dada41e602d70e12e7351c2
    keggFromMMseqs2:
      database:
        extractedDBPath: "/vol/spool/toolkit/kegg-links-mirror-202506/" 
  cooccurrence:
    inference:
      additionalParams: 
        method: 'correlation'
        rscript: " --mincovthreshold 0.1 --maxzero 110 --minweight 0.4 "
        timeLimit: "AUTO"
    metabolicAnnotation:
      additionalParams:
        metabolicEdgeBatches: 20
        metabolicEdgeReplicates: 3
        smetana: " --molweight "
  plasmid:
    SCAPP:
      additionalParams: 
        SCAPP: "  "
        bwa2: "  "
        samtoolsViewBwa2: " -F 3584 " 
        samtoolsViewMinimap: " " 
        coverm: "  "
        minimap: " "
    ViralVerifyPlasmid:
      filter: true
      filterString: "Uncertain - plasmid or chromosomal|Plasmid"
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/Pfam-A_37.4.hmm.gz
          md5sum: 9ca99e4396bb7c123e884057e91eff8d
      additionalParams: " --thr 7 "
    MobTyper:
      filter: true
      minLength: 5000
      additionalParams: " --min_length 9000  "
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/mob_20250620.tar.gz
          md5sum: d73fce2d4fc03ca8466b8b1baf1e5634
    Platon:
      filter: false
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/platon_20220929.tar.gz
          md5sum: f6d1701704396182c6c9daca053eb9d6
      additionalParams: "   "
    PlasClass:
      filter: true
      threshold: 0.5 
      additionalParams: "   "
    Filter:
      method: "AND"
      minLength: 0 
    PLSDB:
      sharedKmerThreshold: 30
      database:
        download:
          source: https://openstack.cebitec.uni-bielefeld.de:8080/databases/plasmids_plsdb_20250618.tar.bz2
          md5sum: c860e17ce5c0e87d7f21e57fbecdca91
      additionalParams:
          mashSketch: " -S 42 -k 21 -s 1000 "
          mashDist: " -v 0.2 -d 0.2 "
  export:
    emgb:
      additionalParams:
              blastDB: "bacmet20_predicted"
              taxonomyDB: "gtdb"
      titles:
        database:
          download:
            source: "https://openstack.cebitec.uni-bielefeld.de:8080/databases/uniref90.titles.202506.tsv.gz"
            md5sum: 65437094361e84756e156c54d3a6e56b
      kegg:
        database:
          download:
            source: s3://databases_internal/annotatedgenes2json_db_kegg-mirror-2025-05.tar.zst
            md5sum: 94169a92d453f55553aa7edf4546d00d
            s5cmd:
              params: '--retry-count 30 --no-verify-ssl --endpoint-url https://openstack.cebitec.uni-bielefeld.de:8080'
resources:
  highmemLarge:
    cpus: 28
    memory: 230
  highmemMedium:
    cpus: 14
    memory: 113
  large:
    cpus: 28
    memory: 58
  medium:
    cpus: 14
    memory: 29
  small:
    cpus: 7
    memory: 14
  tiny:
    cpus: 1
    memory: 1

